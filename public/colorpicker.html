<html>
<head>
	<title> color picker </title>
	<style type="text/css">

		/*! normalize.css v3.0.0 | MIT License | git.io/normalize */
		html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
		body{margin:0}
		article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
		audio,canvas,progress,video{display:inline-block;vertical-align:baseline}
		audio:not([controls]){display:none;height:0}
		[hidden],template{display:none}
		a{background:transparent}
		a:active,a:hover{outline:0}
		abbr[title]{border-bottom:1px dotted}
		dfn{font-style:italic}
		h1{font-size:2em;margin:.67em 0}
		mark{background:#ff0;color:#000}
		small{font-size:80%}
		sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
		sup{top:-.5em}
		sub{bottom:-.25em}
		img{border:0}
		svg:not(:root){overflow:hidden}
		figure{margin:1em 40px}
		hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
		code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}
		button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}
		button{overflow:visible}
		button,select{text-transform:none}
		button,html input[type=button],/* 1 */
		input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
		button[disabled],html input[disabled]{cursor:default}
		input{line-height:normal}
		input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}
		input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}
		input[type=search]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
		input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}
		fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
		table{border-collapse:collapse;border-spacing:0}
		td,th{padding:0}
		b,strong,optgroup{font-weight:700}
		pre,textarea{overflow:auto}
		button::-moz-focus-inner,input::-moz-focus-inner,legend{border:0;padding:0}

		html, body {
		  margin: 0;
		  width: 100%; 
		  background-color: #ccc;
		  -webkit-box-sizing: border-box; /* Safari/Crome, other WebKit */
		  -moz-box-sizing: border-box;    /* Firefox, other Gecko */
		  box-sizing: border-box;         /* Opera/IE 8+ */
		}

		body {
		  padding: 20px;
		  font-family: "Helvetica Neue", "Arial", "Lucida Grande", "Lucida Sans Unicode", "Microsoft YaHei", sans-serif;
		  font-size: 14px;
		  line-height: 1.5;
		  min-width: 440px;
		  box-shadow: 0px 0px 10px #888 inset;
		} 

		/* colorpicker styles */

		canvas { display: block; }
		.colorpicker {
		    background-color: #ccc;
		    color: #FFFFFF;
		    font-size: 12px;
		}
		#picker, #bar {
		    cursor: crosshair;
		    margin: 10px;
		    border: 0;
		}
		#swatch { 
			border: 1px solid #2F2F2F;
			margin: 10px; 
			border-radius: 5px;
		}
		.controls {
		    margin: 10px;
		    width:256px;
		}
		.controls > div {
		    border: 1px solid #2F2F2F;
		    border-radius: 5px;
		    margin-bottom: 5px;
		    overflow: hidden;
		    padding: 5px;
		    background-color: #222;
		}
		.controls label {
		    float: left;
		}
		.controls > div input {
		    background-color: #121212;
		    border: 1px solid #2F2F2F;
		    color: #DDDDDD;
		    float: right;
		    font-size: 16px;
		    height: 24px;
		    margin-left: 6px;
		    text-align: center;
		    width: 200px;
		}


	</style>
</head>
<body>

	<br><br>

	<!-- colorpicker element -->
	<div class="colorpicker">
	    <canvas id="picker" width="256" height="256"></canvas>
	    <canvas id="bar" width="256" height="32"></canvas>
	    <div class="controls">
	        <!-- <div><label>R</label> <input type="text" id="rVal" /></div> -->
	        <!-- <div><label>G</label> <input type="text" id="gVal" /></div> -->
	        <!-- <div><label>B</label> <input type="text" id="bVal" /></div> -->
	        <div><label>RGBA</label> <input type="text" id="rgbVal" /></div>
	        <div><label>HEX</label> <input type="text" id="hexVal" /></div>
	    </div>
	    <canvas id="swatch" width="256" height="128"></canvas>
	</div>


	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js" type="text/javascript"><\/script>')</script>	
	<script>
		
		document.body.style.height = window.innerHeight+"px";


		// setup 

		var canvas = document.getElementById('picker');
		var ctx = canvas.getContext('2d');
		var canvas2 = document.getElementById('bar');
		var ctx2 = canvas2.getContext('2d');
		var canvas3 = document.getElementById('swatch');
		var ctx3 = canvas3.getContext('2d');
		var W = canvas.width;
		var H = canvas.height;


		var grd = ctx.createLinearGradient(0,H/2,W,H/2 );
		grd.addColorStop(0, 'rgb(255,255,255)');   
		grd.addColorStop(1, 'rgb(255,0,0)');
		ctx.fillStyle = grd;
		ctx.fillRect(0,0,W,H);

		var sat = new Image();
		sat.onload = function(){
			ctx.drawImage( this, 0, 0 );
		}
		sat.src = "js/colorpicker/saturation_value_gradient.png";

		var horiz = new Image();
		horiz.onload = function(){
			ctx2.drawImage( this, 0, 0 );
		}
		horiz.src = "js/colorpicker/hue_gradient_horiz.png";

		ctx3.fillStyle = "red";
		ctx3.fillRect(0,0,canvas3.width,canvas3.height);



		// 

		function draw(r,g,b){
			var grd = ctx.createLinearGradient(0,H/2,W,H/2 );
			grd.addColorStop(0, 'rgb(255,255,255)');   
			grd.addColorStop(1, 'rgb('+r+','+g+','+b+')');
			ctx.fillStyle = grd;
			ctx.fillRect(0,0,W,H);
			ctx.drawImage( sat, 0, 0 );
		}


		function getPixel(x, y) {
		    var p = ctx.getImageData(x, y, 1, 1).data; 
		    var c = {r:p[0], g:p[1], b:p[2] };

		    // $('#rVal').val( c.r );
		    // $('#gVal').val( c.g );
		    // $('#bVal').val( c.b );

		    var rgb = "rgba(" +c.r+", "+ c.g+", "+ c.b+", 1.0)";
		    $("#rgbVal").val ( rgb );

		    var hex = "#" +((c.r << 16) | (c.g << 8) | c.b).toString(16);
		    $("#hexVal").val ( hex );   

		    // fill swatch
		    ctx3.fillStyle = hex;
			ctx3.fillRect(0,0,canvas3.width,canvas3.height);
		}

		function getHue(x, y) {
		    var pxl = ctx2.getImageData(x, y, 1, 1).data; 
		    draw( pxl[0], pxl[1], pxl[2] );					   
		}


		var over = false;
		$('#picker').on({
			mouseover: function(){ over = true },
			mouseout: function(){ over = false }
		});

		var hue_over = false;
		$('#bar').on({
			mouseover: function(){ hue_over = true },
			mouseout: function(){ hue_over = false }
		});

		document.onmousedown = function(e){

			var hx,x;
			var hy, y;
			if (e.pageX || e.pageY) { 
			  x = hx = e.pageX;
			  y = hy = e.pageY;
			}
			else { 
			  x = hx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft; 
			  y = hy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop; 
			} 

			x -= canvas.offsetLeft;
			y -= canvas.offsetTop;

			hx -= canvas2.offsetLeft;
			hy -= canvas2.offsetTop;

			if(over) getPixel( x,y );
			if(hue_over) getHue( hx,hy );
		}

	
	</script>


</body>
</html>